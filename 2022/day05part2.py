# same as part 1 pretty much, see comments towards end